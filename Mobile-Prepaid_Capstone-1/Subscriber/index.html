<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MobilePrepaid</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
    <link rel="stylesheet" href="./css/style.css">
</head>
<body>

    <!-- Navbar -->
    <nav class="navbar navbar-expand-lg navbar-light bg-white shadow-sm">
        <div class="container">
            <a class="navbar-brand" href="#">
                <img src="./assets/logo-finalz.png" alt="Logo" height="50" width="100"> <!-- Replace with your logo -->
            </a>
            
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>

            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav mx-auto">
                    <li class="nav-item"><a class="nav-link" href="./index.html">Home</a></li>
                    <li class="nav-item"><a class="nav-link" href="./Prepaid.html">Prepaid</a></li>
                    <li class="nav-item"><a class="nav-link" href="#zen">Recharge</a></li>
                    <li class="nav-item"><a class="nav-link" href="./Help.html">Help</a></li>
                </ul>

                <div class="d-flex align-items-center">
                    <div class="dropdown" id="profile-dropdown">
                        <!-- Profile icon or username will be updated dynamically -->
                        <a href="#" class="nav-link" id="profile-toggle">
                            <span id="profile-content">
                                <i class="bi bi-person fs-4"></i>
                                <svg xmlns="http://www.w3.org/2000/svg" width="30" height="40" fill="black" class="bi bi-person" viewBox="0 0 16 16">
                                    <path d="M8 8a3 3 0 1 0 0-6 3 3 0 0 0 0 6m2-3a2 2 0 1 1-4 0 2 2 0 0 1 4 0m4 8c0 1-1 1-1 1H3s-1 0-1-1 1-4 6-4 6 3 6 4m-1-.004c-.001-.246-.154-.986-.832-1.664C11.516 10.68 10.289 10 8 10s-3.516.68-4.168 1.332c-.678.678-.83 1.418-.832 1.664z"/>
                                </svg>
                            </span>
                        </a>
                        <div class="dropdown-menu" id="dropdown-menu">
                            <a class="dropdown-item" href="./Profile2.html">My Profile</a>
                            <a class="dropdown-item" href="#" id="logout-btn">Logout</a>
                        </div>
                    </div>
                </div>
                
                
            </div>
        </div>
        
    </nav>
    
    
<div id="carouselExample" class="carousel slide" data-bs-ride="carousel" data-bs-interval="6000">
    <div class="carousel-inner">
        <div class="carousel-item active">
            <img src="./assets/Share happiness through (1).png"  class="d-block w-100" alt="Slide 1"> 
        </div>
        <div class="carousel-item">
            <img src="./assets/pexels-photo-3791664.webp"  class="d-block w-100" alt="Slide 2">
        </div>
        <div class="carousel-item">
            <img src="./assets/carousel-3.jpeg" class="d-block w-100" alt="Slide 3">
        </div>
    </div>

   
    <button class="carousel-control-prev" type="button" data-bs-target="#carouselExample" data-bs-slide="prev">
        <span class="carousel-control-prev-icon" aria-hidden="true"></span>
    </button>
    <button class="carousel-control-next" type="button" data-bs-target="#carouselExample" data-bs-slide="next">
        <span class="carousel-control-next-icon" aria-hidden="true"></span>
    </button>
</div>

<section class="full-width-section packs-section">
    <h2>Packâ€™s that you'll love</h2>
    <div id="prepaid-plans-container" class="d-flex justify-content-center gap-3 flex-wrap">
    </div>
</section>
<br>


<section class="container text-center phone-section" id="zen" style="max-width: 50%;">
    <h2>For a Quick Recharge</h2>
    <div class="input-group my-3 mx-auto" style="max-width: 400px;">
        <input type="tel" id="quick-recharge-number" class="form-control" placeholder="Enter phone number" style="font-size: small;">
        <button class="btn btn-danger" id="quick-recharge-btn">Go</button>
    </div>
</section>
<script src="/Mobile-Prepaid_Capstone-1/Subscriber/js/script.js"></script>  
<br>


<section class="full-width-section connect-section">
    <div class="d-flex justify-content-center">
        <img src="./assets/Your paragraph text (3).jpg" class="full-width-image" alt="Globe Animation">
    </div>
</section>


<section class="faq-section container my-5 p-4" style="background: linear-gradient(135deg, #ffffff, #ffffff); border-radius: 12px; padding: 40px; box-shadow: 0 8px 16px rgba(0, 0, 0, 0.1);">
    <h2 class="text-center text-black mb-4">Frequently Asked Questions</h2>
    <div class="accordion" id="faqAccordion">
        <div class="accordion-item" style="background-color: #F9F9F9; border-radius: 8px; border: none; margin-bottom: 12px; box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);">
            <h2 class="accordion-header">
                <button class="accordion-button text-white" type="button" data-bs-toggle="collapse" data-bs-target="#faq1" style="background-color: #eb5151; border-radius: 8px;">
                    What is mobile prepaid?
                </button>
            </h2>
            <div id="faq1" class="accordion-collapse collapse show" data-bs-parent="#faqAccordion">
                <div class="accordion-body text-dark">
                    A mobile prepaid plan allows you to pay for your mobile service in advance, without a contract. You load your account with a set amount of money and use it until your balance runs out.
                </div>
            </div>
        </div>

        <div class="accordion-item" style="background-color: #F9F9F9; border-radius: 8px; border: none; margin-bottom: 12px; box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);">
            <h2 class="accordion-header">
                <button class="accordion-button collapsed text-white" type="button" data-bs-toggle="collapse" data-bs-target="#faq2" style="background-color: #eb5151; border-radius: 8px;">
                    Are there activation fees?
                </button>
            </h2>
            <div id="faq2" class="accordion-collapse collapse" data-bs-parent="#faqAccordion">
                <div class="accordion-body text-dark">
                    No, there are no activation fees. You pay only for the plan and top-ups you choose.
                </div>
            </div>
        </div>

        <div class="accordion-item" style="background-color: #F9F9F9; border-radius: 8px; border: none; box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);">
            <h2 class="accordion-header">
                <button class="accordion-button collapsed text-white" type="button" data-bs-toggle="collapse" data-bs-target="#faq3" style="background-color: #eb5151; border-radius: 8px;">
                    Do you offer refunds?
                </button>
            </h2>
            <div id="faq3" class="accordion-collapse collapse" data-bs-parent="#faqAccordion">
                <div class="accordion-body text-dark">
                    Refund policies vary depending on the service or plan you purchased. Please check our terms.
                </div>
            </div>
        </div>
    </div>
</section>

<footer class="footer bg-dark text-white text-center py-4">
    <div class="container">
        <p>&copy; 2024 Your Website. All Rights Reserved.</p>
        <nav>
            <a href="#" class="text-white mx-2">Privacy Policy</a> |
            <a href="#" class="text-white mx-2">Terms of Service</a> |
            <a href="#" class="text-white mx-2">Contact</a>
        </nav>
        <div class="mt-3">
            <a href="#" class="text-white mx-2">Facebook</a>
            <a href="#" class="text-white mx-2">Twitter</a>
            <a href="#" class="text-white mx-2">Instagram</a>
        </div>
    </div>
</footer>

    <!-- SweetAlert2 CDN -->
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
<script>

        document.addEventListener('DOMContentLoaded', function() {
        // Get the current page filename
        var path = window.location.pathname;
        var page = path.split("/").pop();
        
        // Select all nav links
        var navLinks = document.querySelectorAll('.navbar .nav-link');
        
        // Check each link and add active class based on current page
        navLinks.forEach(function(link) {
            var href = link.getAttribute('href');
            
            // For the home page
            if (page === "" || page === "/" || page === "index.html") {
                if (href === "./index.html") {
                    link.classList.add('active');
                }
            }
            // For prepaid page
            else if (page === "Prepaid.html") {
                if (href === "./Prepaid.html") {
                    link.classList.add('active');
                }
            }
            // For recharge section (if on the same page with #zen anchor)
            else if (window.location.hash === "#zen") {
                if (href === "#zen") {
                    link.classList.add('active');
                }
            }
            // For help page
            else if (page === "./help.html" || href === "#" && page !== "phone.html") {
                if (href === "#" && !link.querySelector('svg')) {
                    link.classList.add('active');
                }
            }
            // For any other specific page match
            else if (href.includes(page)) {
                link.classList.add('active');
            }
        });
    });


    document.addEventListener("DOMContentLoaded", function () {
    let isLoggedIn = localStorage.getItem("isLoggedIn") === "true";
    let userDetails = JSON.parse(localStorage.getItem("userDetails")) || null;
    let profileDropdown = document.getElementById("profile-dropdown");
    let dropdownMenu = document.getElementById("dropdown-menu");

    // Hide dropdown if not logged in
    if (!isLoggedIn) {
        dropdownMenu.style.display = "none";
    } else if (userDetails && userDetails.fullName) {
        updateAuthUI(userDetails.fullName); //  Call updateAuthUI() only when logged in
    }

    let profileIcon = profileDropdown.querySelector(".nav-link");

    profileIcon.addEventListener("click", function (event) {
        event.preventDefault();

        if (isLoggedIn) {
            dropdownMenu.classList.toggle("show");
        } else {
            window.location.href = "phone.html";
        }
    });

    document.getElementById("logout-btn")?.addEventListener("click", function () {
        logout();
    });

    loadBestsellers();
});

// Function to update profile dropdown with user's name
function updateAuthUI(fullName) {
    const profileDropdown = document.getElementById("profile-dropdown");

    if (profileDropdown) {
        profileDropdown.innerHTML = `
            <a href="#" class="nav-link">
                <i class="bi bi-person fs-4"></i> ${fullName}
            </a>
            <div class="dropdown-menu" id="dropdown-menu">
                <a class="dropdown-item" href="./Profile.html">My Profile</a>
                <a class="dropdown-item" href="#" id="logout-btn">Logout</a>
            </div>
        `;
    }

    // Reattach logout event after updating DOM
    document.getElementById("logout-btn")?.addEventListener("click", logout);
}

// Logout function
function logout() {
    localStorage.clear();
    window.location.href = "index.html";
} 

// Function to load bestseller plans into the container
async function loadBestsellers() {
    try {
        const response = await fetch('http://localhost:8083/api/plans');
        const plans = await response.json();
        const bestsellersContainer = document.getElementById('prepaid-plans-container');

        bestsellersContainer.innerHTML = '';

        const bestsellers = plans.filter(plan => plan.bestseller).slice(0, 3);

        bestsellers.forEach(plan => {
            const planCard = document.createElement('div');
            planCard.classList.add('card', 'p-3', 'mb-3', 'plan-card');
            planCard.style.width = '18rem';
            planCard.style.height = '15rem';

            planCard.innerHTML = `
                <h5 class="card-title">${plan.price} <small><span class="badge bg-danger">Bestseller</span></h5></small>
                <p class="card-ott"><strong>Data:</strong> ${plan.data}</p>
                <p class="card-validity"><strong>Validity:</strong> ${plan.validity}</p>
                <p class="card-text">${plan.benefits}</p>
                <div class="mt-auto">
                    <button class="btn btn-danger w-95 recharge-btn" data-plan="${plan.name}" data-price="${plan.price}">Recharge Now</button>
                </div>
            `;
            bestsellersContainer.appendChild(planCard);
        });
    } catch (error) {
        console.error('Error fetching plans:', error);
    }
}

// Restrict recharge option if user is not logged in
document.addEventListener("click", function (event) {
    if (event.target.classList.contains("recharge-btn")) {
        let isLoggedIn = localStorage.getItem("isLoggedIn") === "true";

        if (isLoggedIn) {
            let planName = encodeURIComponent(event.target.getAttribute("data-plan"));
            let price = encodeURIComponent(event.target.getAttribute("data-price"));
            window.location.href = `payment.html?plan=${planName}&price=${price}`;
        } else {
            Swal.fire({
                title: "Login Required",
                text: "Please log in to continue with the recharge.",
                icon: "warning",
                confirmButtonColor: "#d9534f",
                confirmButtonText: "OK"
            }).then(() => {
                window.location.href = "phone.html";
            });
        }
    }
});


    </script>
    
</body>
</html>
